[mysqld]
# Percona Server 8.4 with MyRocks - BULK LOAD CONFIGURATION
# WARNING: These settings prioritize speed over durability
# Use only for data preparation, not for benchmarking or production
user = mysql
port = 3306
socket = /tmp/mysql_percona_myrocks.sock
pid-file = /tmp/mysql_percona_myrocks.pid
datadir = /mnt/nvme/mysql-percona-myrocks/data

# Storage Engine
default-storage-engine = ROCKSDB

# Load RocksDB Plugin
plugin-load-add = ha_rocksdb.so

# Transaction and Collation Settings (recommended for MyRocks)
transaction-isolation = READ-COMMITTED
character-set-server = latin1
collation-server = latin1_bin

# Binary log (ROW format)
binlog_format = ROW

# Disable query logging
slow_query_log = 0
general_log = 0

# Disable Performance Schema
performance_schema = OFF

# ============================================
# BULK LOAD OPTIMIZATIONS (RocksDB-specific)
# ============================================

# DANGEROUS: Enable RocksDB bulk load mode
# This bypasses compaction and uniqueness checks for maximum speed
rocksdb_bulk_load = 1

# Allow bulk load to work with unsorted input
rocksdb_bulk_load_allow_unsorted = 1

# Do NOT enable rocksdb_commit_in_the_middle here.
# It causes partial commits on connection failure, and combined with
# rocksdb_bulk_load (which skips uniqueness checks), tpcc_load retries
# would silently create duplicate rows.

# Total write buffer memory limit across all column families (2GB)
rocksdb_db_write_buffer_size = 2G

# Per-column family options: write_buffer_size and max_write_buffer_number
# Disable compression for fair architectural comparison
rocksdb_default_cf_options = write_buffer_size=256m;max_write_buffer_number=8;compression=kNoCompression

# Enable concurrent memtable writes for better multi-core performance
rocksdb_allow_concurrent_memtable_write = ON

# Unlimited open files (avoid open/close overhead)
rocksdb_max_open_files = -1

# More background jobs for compaction/flush
rocksdb_max_background_jobs = 8

# Disable WAL sync for speed (DANGEROUS)
rocksdb_flush_log_at_trx_commit = 0

# DANGEROUS: Disable binary log sync
sync_binlog = 0

# Increase max connections for parallel loaders
max_connections = 200

# Increase timeouts for bulk load (RocksDB can stall during SST ingestion)
net_read_timeout = 600
net_write_timeout = 600

# Increase sort buffer for index creation
sort_buffer_size = 64M
read_buffer_size = 16M

[client]
socket = /tmp/mysql_percona_myrocks.sock
